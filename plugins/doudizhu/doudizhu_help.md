## 斗地主帮助

本文档旨在为[AntiLeaf](https://github.com/antileaf)开发的[Bot](https://中的斗地主功能提供帮助。

****

**为保证您的游戏体验，建议在阅读本文档并熟悉斗地主游戏中需要用到的指令后再进行游戏。**

### 关于斗地主

斗地主游戏的详细介绍在此不再赘述。

斗地主在各地区的规则或许稍有不同，这里采用的是比较常见的一种规则：**允许四带二（带两张单或者两对）、允许飞机不带或带1/2张牌、不允许连炸。**

为方便起见，大小王分别用`王`、`鬼`代替，当然你在出牌时可以使用`大王/小王`的名称，bot会自动进行转换。

### 指令一览

为避免与其他bot混淆，**请在所有指令前加前缀"%"**。另外下面的加号并不是真的输入加号，而是提示中间需要空格分隔。

- `加入/加入游戏/上桌`：加入当前群的游戏
    - 多个群可以同时进行游戏，你也可以同时加入多个群的游戏（如果你不怕分不清手牌）
- `退出/下桌`：退出当前群的游戏（前提是还没有开始）
- `开始/开始游戏`：开始当前群的游戏（只有已加入游戏的人可以使用）
- `状态`：查询各位玩家手牌数、当前出牌顺序、当前出牌的玩家等信息
- `叫地主/叫`：叫地主
- `不叫`：不叫地主
- `抢地主/抢`：抢地主
- `不抢`：不抢地主
- `明牌`：明牌，只能在还没有人出过牌时使用；在结算时，每有一名明牌玩家，则所有明牌玩家的分数变化就会翻倍（未明牌玩家不受影响）
- `出/出牌`：后面接你要出的牌（不带空格，不分大小写，不分顺序）
    - 例：`%出 73878768`（注：`77788836`，飞机）
- `不出/过`：不出
- `记牌`：记牌器，显示当前还有哪些牌没有出过
- `排行榜/rank`：查询所有玩家的MMR排名情况
- `查询 [名字/qq]`：查询指定玩家的统计数据，如果没有指定名字就查询自己的
    - 玩家的名字默认会设为群名片，如果需要改名请使用`%改名`
- `改名 + 名字`：把自己的名字改为指定的名字
- `观战/ob`：观战该群正在进行的游戏，bot会把手牌私发给你（当然正在游戏的玩家是无法使用的）

为方便起见，大部分指令都可以用拼音简写代替汉字，例如`叫地主`可以简写为`jdz`或者`j`，`加入游戏`可以简写为`jr`或者`sz`。

### 关于MMR算法

为增加斗地主的趣味性，我为斗地主功能增加了一个MMR系统，可以大致地衡量一名玩家的水平。（当然只能维护一个分数，没办法做排名系统，因为人数太少。）

在我看来，一个合理的MMR算法应当具备以下特点：

- 显然胜场会加分，负场会减分，但对MMR较高的玩家应该适当减少加分，增加减分；反之对MMR较低的玩家亦然。
- 为鼓励玩家的积极性，玩家的期望MMR应当随游戏局数的增加而略微上升。

因此，我设计的MMR算法采用了sigmoid函数（$f(x) = \frac 1 {1 + e^{-x}}$）来计算每位玩家的MMR增减，同时每局游戏会固定最终加10分的奖励分。

MMR算法的细节不再赘述，有兴趣可以自行查看`/plugins/doudizhu/statistics.py`中的`calc_delta`函数。